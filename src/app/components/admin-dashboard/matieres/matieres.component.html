<div class="container">
  <div class="left">
    <div class="page-header">
      <h2>Gestion des Mati√®res</h2>
      <button class="add-btn" (click)="toggleForm()">
        {{ isAddForm ? "Fermer ‚û°Ô∏è" : "Ajouter une mati√®re" }}
      </button>
    </div>

    <div *ngIf="successMessage" class="alert success">{{ successMessage }}</div>
    <div *ngIf="errorMessage" class="alert error">{{ errorMessage }}</div>

    <table class="styled-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Mati√®re</th>
          <th>Niveau</th>
          <th>Coefficient</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let mat of paginatedMatieres; let i = index">
          <td>{{ mat.id }}</td>
          <td>{{ mat.nom }}</td>
          <td>{{ mat.niveau }}</td>
          <td>{{ mat.coefficient }}</td>
          <td>
            <button (click)="editMatiere(i)">‚úèÔ∏è</button>
            <button class="danger" (click)="confirmDelete(mat)">üóëÔ∏è</button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="pagination-controls">
      <button (click)="changePage(-1)" [disabled]="currentPage === 1">
        ‚¨ÖÔ∏è Pr√©c√©dent
      </button>
      <span>Page {{ currentPage }} / {{ totalPages }}</span>
      <button
        (click)="changePage(1)"
        [disabled]="currentPage * itemsPerPage >= matieres.length"
      >
        Suivant ‚û°Ô∏è
      </button>
    </div>
  </div>
  <div class="right" *ngIf="isAddForm">
    <form [formGroup]="matiereForm" (ngSubmit)="onSubmit()" class="form-card">
      <div class="form-header">
        <h2>Nouvelle Mati√®re</h2>
      </div>
      <div>
        <label for="nom">Nom</label>
        <input id="nom" name="nom" type="text" formControlName="nom" />
      </div>

      <div>
        <label for="code">Code</label>
        <input id="code" name="code" type="text" formControlName="code" />
      </div>

      <div>
        <label for="coefficient">Coefficient</label>
        <input
          id="coefficient"
          type="number"
          formControlName="coefficient"
          step="0.1"
          name="coefficient"
        />
      </div>

      <div>
        <label for="niveau">Niveau</label>
        <select id="niveau" name="niveau" formControlName="niveau">
          <option value="">-- S√©lectionner --</option>
          <option value="6e">6e</option>
          <option value="5e">5e</option>
          <option value="4e">4e</option>
          <option value="3e">3e</option>
          <option value="Seconde">Seconde</option>
          <option value="Premi√®re">Premi√®re</option>
          <option value="Terminale">Terminale</option>
        </select>
      </div>

      <div>
        <label for="description">Description</label>
        <textarea
          id="description"
          name="description"
          formControlName="description"
        ></textarea>
      </div>

      <button type="submit" [disabled]="matiereForm.invalid">
        Enregistrer
      </button>
    </form>
  </div>
</div>

<app-confirm-dialog
  *ngIf="showConfirm"
  title="Confirmation"
  [message]="
    'Voulez-vous vraiment supprimer la mati√®re ' + selectedMatiere?.nom + ' ?'
  "
  (confirm)="deleteMatiere()"
  (cancel)="showConfirm = false"
></app-confirm-dialog>
